Fine collection service is a stateless service that could be subject of peaks of request. To ensure that the service can handle the load, it is important to scale the service out to multiple instances when needed. Container Apps can scale up to [300 replicas per revision](https://learn.microsoft.com/en-us/azure/container-apps/scale-app?pivots=azure-cli#scale-definition). For example, if there is an increase in the traffic during the day, the probability of having more speed violation could be higher, the amount of messages in the topic could increase and the service could be subject of peaks of request. In this case, the service should be scaled out to multiple instances to handle the load.

On an other hand, the service is not used all the time. For example, during the night, there could be less traffic and the service could not be used. If there is no message in the topic (i.e. no speed violation), the service can be scaled to zero replicas to save cost. Indeed if a container app has zero replicas, [no resource consumption charges are incurred](https://learn.microsoft.com/en-us/azure/container-apps/billing#no-replicas-are-running) for this application (if the container app is deploy to a consumption workload).

In this assignment, you are going to [scale](https://learn.microsoft.com/en-us/azure/container-apps/scale-app?pivots=azure-cli#custom) fine collection service from 0 to 5 replicas, i.e. to define a scaling rule for `ca-fine-collection-service` container apps. To do so, you are going to use [KEDA](https://keda.sh/) that is supported out of the box by Azure Container Apps. This open source project can drove the scaling of any container in Azure Container Apps based on the nummber of events needing to be processed. For fine collection service, [Azure Service Bus scaler](https://keda.sh/docs/2.11/scalers/azure-service-bus/) is used. It scales the container app replicas based on the number of messages on a topic or a queue.